================================================================================
Impala: Compute stats
================================================================================

COMPUTE STATS my_table (col1);

--------------------------------------------------------------------------------

(program
  (statement
    (keyword_compute)
    (keyword_stats)
    (table_reference
      (identifier))
    (field
      (identifier))))

================================================================================
Impala: Compute incremental stats
================================================================================

COMPUTE INCREMENTAL STATS my_table PARTITION (partition_col=col1);

--------------------------------------------------------------------------------

(program
  (statement
    (keyword_compute)
    (keyword_incremental)
    (keyword_stats)
    (table_reference
      (identifier))
    (keyword_partition)
    (table_option
      (identifier)
      (identifier))))

================================================================================
Hive: Analyze and Compute stats
================================================================================

ANALYZE TABLE mytable
PARTITION (partcol1=col1, partcol2=col2)
COMPUTE STATISTICS
FOR COLUMNS
CACHE METADATA
NOSCAN

--------------------------------------------------------------------------------

(program
  (statement
    (keyword_analyze)
    (keyword_table)
    (table_reference
      (identifier))
    (keyword_partition)
    (table_option
      (identifier)
      (identifier))
    (table_option
      (identifier)
      (identifier))
    (keyword_compute)
    (keyword_statistics)
    (keyword_for)
    (keyword_columns)
    (keyword_cache)
    (keyword_metadata)
    (keyword_noscan)))

================================================================================
Athena/Iceberg: Optimize table
================================================================================

OPTIMIZE mytable REWRITE DATA USING BIN_PACK
  WHERE col1 is not null
--------------------------------------------------------------------------------

(program
  (statement
    (keyword_optimize)
    (table_reference
      (identifier))
    (keyword_rewrite)
    (keyword_data)
    (keyword_using)
    (keyword_bin_pack)
    (where
      (keyword_where)
      (binary_expression
        (field
          (identifier))
        (is_not
          (keyword_is)
          (keyword_not))
        (literal
          (keyword_null))))))
